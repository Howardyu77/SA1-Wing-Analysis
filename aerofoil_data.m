

%  Read in the parameter file
caseref = 'naca0012@3e6';
parfile = ['Parfiles/' caseref '.txt'];
fprintf(1, '%s\n\n', ['Reading in parameter file: ' parfile])
[section1 np Re1 alpha] = par_read(parfile);
%  Read in the parameter file
caseref = 'naca4412@3e6';
parfile = ['Parfiles/' caseref '.txt'];
fprintf(1, '%s\n\n', ['Reading in parameter file: ' parfile])
[section2 np Re2 alpha] = par_read(parfile);

[xs, ys, alpha1,cp1, clswp1, cdswp1, lovdswp1,gam1] = foil_function('naca0012@3e6');

[xs, ys, alpha2,cp2, clswp2, cdswp2, lovdswp2,gam2] = foil_function('naca4412@3e6');

%Abbott, I. H. and von Doenhoff
%naca4412 @Re 3e6
naca4412_cl=[1.26552000000000;1.32971000000000;1.39720000000000;1.45971000000000;1.51892000000000;1.53047000000000;1.43523000000000;1.32522000000000;1.16753000000000;0.607148000000000;0.161599000000000;-0.0472650000000000;-0.456859000000000];
naca4412_alpha=[20.2295000000000;18.3110000000000;16.1367000000000;15.1142000000000;14.0597000000000;13.3240000000000;11.8173000000000;9.73394000000000;7.71304000000000;1.99818000000000;-2.33859000000000;-4.17082000000000;-8.28448000000000];


%naca0012 @6e6
naca0012_alpha=[-17.2794000000000;-16.2296000000000;-15.8616000000000;-15.1713000000000;-14.3133000000000;-13.2811000000000;-12.2535000000000;-11.2222000000000;-10.1947000000000;-8.14138000000000;-6.25579000000000;-5.22822000000000;-4.19972000000000;-1.96944000000000;0;0.940006000000000;1.96944000000000;2.99515000000000;3.85131000000000;4.87888000000000;5.90831000000000;7.96346000000000;10.1891000000000;11.0471000000000;13.1088000000000;16.3759000000000;16.5678000000000;17.2971000000000];
naca0012_cl=[-1.25323000000000;-1.34704000000000;-1.54416000000000;-1.51805000000000;-1.44038000000000;-1.37120000000000;-1.25912000000000;-1.18135000000000;-1.06927000000000;-0.827958000000000;-0.638207000000000;-0.526128000000000;-0.422627000000000;-0.215533000000000;0;0.120611000000000;0.215533000000000;0.344770000000000;0.439599000000000;0.551678000000000;0.646600000000000;0.870758000000000;1.12074000000000;1.19842000000000;1.36252000000000;1.59591000000000;1.42443000000000;1.09024000000000];
naca0012_cd=[0.0127127000000000;0.00986522000000000;0.00856238000000000;0.00751899000000000;0.00691128000000000;0.00656162000000000;0.00621197000000000;0.00594787000000000;0.00576885000000000;0.00593438000000000;0.00592927000000000;0.00600738000000000;0.00659882000000000;0.00745390000000000;0.00779239000000000;0.00915707000000000;0.0112969000000000;0.0133515000000000];
naca0012_cl1=[-1.25583000000000;-1.09305000000000;-0.860237000000000;-0.653233000000000;-0.549778000000000;-0.446183000000000;-0.342588000000000;-0.230298000000000;-0.100665000000000;0.0205051000000000;0.115637000000000;0.262707000000000;0.461945000000000;0.557543000000000;0.661509000000000;0.878463000000000;1.07854000000000;1.26127000000000];
%xfoil prediction @1e6
%0012
x_naca0012_alpha=[-18.5000000000000;-18.2500000000000;-18;-17.7500000000000;-17.5000000000000;-17.2500000000000;-17;-16.7500000000000;-16.5000000000000;-16.2500000000000;-16;-15.7500000000000;-15.5000000000000;-15.2500000000000;-15;-14.7500000000000;-14.5000000000000;-14.2500000000000;-14;-13.7500000000000;-13.5000000000000;-13.2500000000000;-13;-12.7500000000000;-12.5000000000000;-12.2500000000000;-12;-11.7500000000000;-11.5000000000000;-11.2500000000000;-11;-10.7500000000000;-10.5000000000000;-10.2500000000000;-10;-9.75000000000000;-9.50000000000000;-9.25000000000000;-9;-8.75000000000000;-8.50000000000000;-8.25000000000000;-8;-7.75000000000000;-7.50000000000000;-7.25000000000000;-7;-6.75000000000000;-6.50000000000000;-6.25000000000000;-6;-5.75000000000000;-5.50000000000000;-5;-4.75000000000000;-4.50000000000000;-4.25000000000000;-4;-3.75000000000000;-3.50000000000000;-3.25000000000000;-3;-2.75000000000000;-2.50000000000000;-2.25000000000000;-2;-1.75000000000000;-1.50000000000000;-1.25000000000000;-1;-0.750000000000000;-0.500000000000000;-0.250000000000000;0;0.250000000000000;0.500000000000000;0.750000000000000;1;1.25000000000000;1.50000000000000;1.75000000000000;2;2.25000000000000;2.50000000000000;2.75000000000000;3;3.25000000000000;3.50000000000000;3.75000000000000;4;4.25000000000000;4.50000000000000;4.75000000000000;5;5.50000000000000;5.75000000000000;6;6.25000000000000;6.50000000000000;6.75000000000000;7;7.25000000000000;7.50000000000000;7.75000000000000;8;8.25000000000000;8.50000000000000;8.75000000000000;9;9.25000000000000;9.50000000000000;9.75000000000000;10;10.2500000000000;10.5000000000000;10.7500000000000;11;11.2500000000000;11.5000000000000;11.7500000000000;12;12.2500000000000;12.5000000000000;12.7500000000000;13;13.2500000000000;13.5000000000000;13.7500000000000;14;14.2500000000000;14.5000000000000;14.7500000000000;15;15.2500000000000;15.5000000000000;15.7500000000000;16;16.2500000000000;16.5000000000000;16.7500000000000;17;17.2500000000000;17.5000000000000;17.7500000000000;18;18.2500000000000;18.5000000000000];
x_naca0012_cl=[-1.22580000000000;-1.24560000000000;-1.26590000000000;-1.28520000000000;-1.30310000000000;-1.31930000000000;-1.33220000000000;-1.34270000000000;-1.35190000000000;-1.36870000000000;-1.38060000000000;-1.38680000000000;-1.38790000000000;-1.38540000000000;-1.38020000000000;-1.37390000000000;-1.36690000000000;-1.35900000000000;-1.35020000000000;-1.33990000000000;-1.32810000000000;-1.31490000000000;-1.31320000000000;-1.30040000000000;-1.28340000000000;-1.26490000000000;-1.24550000000000;-1.22500000000000;-1.20320000000000;-1.18720000000000;-1.16660000000000;-1.14490000000000;-1.12280000000000;-1.10000000000000;-1.08070000000000;-1.05910000000000;-1.03680000000000;-1.01430000000000;-0.994800000000000;-0.973500000000000;-0.951700000000000;-0.931300000000000;-0.910400000000000;-0.888800000000000;-0.868700000000000;-0.847500000000000;-0.826800000000000;-0.797500000000000;-0.763400000000000;-0.728900000000000;-0.693900000000000;-0.660100000000000;-0.626800000000000;-0.557100000000000;-0.521300000000000;-0.490300000000000;-0.458800000000000;-0.427600000000000;-0.400400000000000;-0.373000000000000;-0.346200000000000;-0.320100000000000;-0.293800000000000;-0.267500000000000;-0.241000000000000;-0.214400000000000;-0.187800000000000;-0.161100000000000;-0.134300000000000;-0.107500000000000;-0.0806000000000000;-0.0538000000000000;-0.0268000000000000;0;0.0269000000000000;0.0538000000000000;0.0806000000000000;0.107500000000000;0.134400000000000;0.161100000000000;0.187800000000000;0.214400000000000;0.241000000000000;0.267500000000000;0.293800000000000;0.320100000000000;0.346200000000000;0.373000000000000;0.400400000000000;0.427600000000000;0.458800000000000;0.490300000000000;0.521300000000000;0.557200000000000;0.626800000000000;0.660100000000000;0.694000000000000;0.729000000000000;0.763500000000000;0.797600000000000;0.826700000000000;0.847400000000000;0.868600000000000;0.888700000000000;0.910300000000000;0.931200000000000;0.951600000000000;0.973400000000000;0.994800000000000;1.01430000000000;1.03680000000000;1.05910000000000;1.08080000000000;1.10010000000000;1.12290000000000;1.14500000000000;1.16680000000000;1.18740000000000;1.20330000000000;1.22510000000000;1.24570000000000;1.26510000000000;1.28370000000000;1.30080000000000;1.31370000000000;1.31570000000000;1.32900000000000;1.34060000000000;1.35090000000000;1.36000000000000;1.36790000000000;1.37500000000000;1.38140000000000;1.38640000000000;1.38920000000000;1.38810000000000;1.38180000000000;1.37020000000000;1.35360000000000;1.34510000000000;1.33520000000000;1.32180000000000;1.30590000000000;1.28800000000000;1.26850000000000;1.24850000000000;1.22840000000000];
x_naca0012_cd=[0.102360000000000;0.0950500000000000;0.0878200000000000;0.0808800000000000;0.0742900000000000;0.0681400000000000;0.0625600000000000;0.0574500000000000;0.0526300000000000;0.0470400000000000;0.0423400000000000;0.0386500000000000;0.0357700000000000;0.0334800000000000;0.0316000000000000;0.0299700000000000;0.0284900000000000;0.0271800000000000;0.0260200000000000;0.0250200000000000;0.0241600000000000;0.0234300000000000;0.0220700000000000;0.0211700000000000;0.0204900000000000;0.0198800000000000;0.0193100000000000;0.0188100000000000;0.0183900000000000;0.0174500000000000;0.0169000000000000;0.0164500000000000;0.0160200000000000;0.0156600000000000;0.0149900000000000;0.0145600000000000;0.0142300000000000;0.0139500000000000;0.0134100000000000;0.0130700000000000;0.0127900000000000;0.0124000000000000;0.0120900000000000;0.0118700000000000;0.0114900000000000;0.0112400000000000;0.0109500000000000;0.0106900000000000;0.0103400000000000;0.0100300000000000;0.00973000000000000;0.00942000000000000;0.00911000000000000;0.00847000000000000;0.00816000000000000;0.00786000000000000;0.00756000000000000;0.00728000000000000;0.00705000000000000;0.00681000000000000;0.00659000000000000;0.00640000000000000;0.00623000000000000;0.00606000000000000;0.00593000000000000;0.00581000000000000;0.00570000000000000;0.00562000000000000;0.00556000000000000;0.00549000000000000;0.00546000000000000;0.00542000000000000;0.00541000000000000;0.00540000000000000;0.00541000000000000;0.00542000000000000;0.00546000000000000;0.00549000000000000;0.00555000000000000;0.00562000000000000;0.00570000000000000;0.00581000000000000;0.00593000000000000;0.00606000000000000;0.00623000000000000;0.00640000000000000;0.00659000000000000;0.00681000000000000;0.00705000000000000;0.00728000000000000;0.00756000000000000;0.00786000000000000;0.00816000000000000;0.00847000000000000;0.00911000000000000;0.00942000000000000;0.00972000000000000;0.0100300000000000;0.0103400000000000;0.0106900000000000;0.0109500000000000;0.0112400000000000;0.0114900000000000;0.0118600000000000;0.0120800000000000;0.0124000000000000;0.0127900000000000;0.0130700000000000;0.0134100000000000;0.0139500000000000;0.0142300000000000;0.0145600000000000;0.0149900000000000;0.0156600000000000;0.0160200000000000;0.0164500000000000;0.0169000000000000;0.0174500000000000;0.0184000000000000;0.0188100000000000;0.0193100000000000;0.0198800000000000;0.0204900000000000;0.0211700000000000;0.0220700000000000;0.0234200000000000;0.0241500000000000;0.0250200000000000;0.0260200000000000;0.0271700000000000;0.0284800000000000;0.0299500000000000;0.0315800000000000;0.0334800000000000;0.0357500000000000;0.0386300000000000;0.0423500000000000;0.0470200000000000;0.0526100000000000;0.0573400000000000;0.0623700000000000;0.0680200000000000;0.0741600000000000;0.0807500000000000;0.0877300000000000;0.0949300000000000;0.102290000000000];

x_naca4412_alpha=[-15.7500000000000;-15.5000000000000;-15.2500000000000;-15;-14.7500000000000;-14.5000000000000;-14.2500000000000;-14;-13.7500000000000;-13.5000000000000;-13.2500000000000;-13;-12.7500000000000;-12.5000000000000;-12.2500000000000;-12;-11.7500000000000;-11.5000000000000;-11.2500000000000;-11;-10.7500000000000;-10.5000000000000;-10.2500000000000;-10;-9.75000000000000;-9.50000000000000;-9.25000000000000;-9;-8.75000000000000;-8.50000000000000;-8.25000000000000;-8;-7.75000000000000;-7.50000000000000;-7.25000000000000;-7;-6.75000000000000;-6.50000000000000;-6;-5.75000000000000;-5.50000000000000;-5;-4.75000000000000;-4.50000000000000;-4.25000000000000;-4;-3.75000000000000;-3.50000000000000;-3.25000000000000;-3;-2.75000000000000;-2.50000000000000;-2.25000000000000;-2;-1.75000000000000;-1.50000000000000;-1.25000000000000;-1;-0.750000000000000;-0.500000000000000;-0.250000000000000;0;0.250000000000000;0.500000000000000;0.750000000000000;1;1.25000000000000;1.50000000000000;1.75000000000000;2;2.25000000000000;2.50000000000000;2.75000000000000;3.25000000000000;3.50000000000000;3.75000000000000;4;4.25000000000000;4.50000000000000;4.75000000000000;5;5.25000000000000;5.50000000000000;5.75000000000000;6;6.25000000000000;6.50000000000000;6.75000000000000;7;7.25000000000000;7.50000000000000;7.75000000000000;8;8.25000000000000;8.50000000000000;8.75000000000000;9;9.25000000000000;9.50000000000000;9.75000000000000;10;10.2500000000000;10.5000000000000;10.7500000000000;11;11.2500000000000;11.5000000000000;11.7500000000000;12;12.2500000000000;12.5000000000000;12.7500000000000;13;13.2500000000000;13.5000000000000;13.7500000000000;14;14.2500000000000;14.5000000000000;14.7500000000000;15;15.2500000000000;15.5000000000000;15.7500000000000;16;16.2500000000000;16.5000000000000;16.7500000000000;17;17.2500000000000;17.5000000000000;17.7500000000000;18;18.2500000000000;18.5000000000000;18.7500000000000];
x_naca4412_cd=[0.0837300000000000;0.0683700000000000;0.0332800000000000;0.0312000000000000;0.0297700000000000;0.0285700000000000;0.0275100000000000;0.0263700000000000;0.0253300000000000;0.0236500000000000;0.0228800000000000;0.0223700000000000;0.0218300000000000;0.0212600000000000;0.0207800000000000;0.0194600000000000;0.0189400000000000;0.0185200000000000;0.0180800000000000;0.0176900000000000;0.0174500000000000;0.0161900000000000;0.0156900000000000;0.0152900000000000;0.0149100000000000;0.0145600000000000;0.0142600000000000;0.0134500000000000;0.0128500000000000;0.0124900000000000;0.0121400000000000;0.0118400000000000;0.0115500000000000;0.0112700000000000;0.0108000000000000;0.0103300000000000;0.0100300000000000;0.00977000000000000;0.00935000000000000;0.00912000000000000;0.00880000000000000;0.00845000000000000;0.00824000000000000;0.00810000000000000;0.00793000000000000;0.00780000000000000;0.00769000000000000;0.00761000000000000;0.00752000000000000;0.00745000000000000;0.00737000000000000;0.00729000000000000;0.00723000000000000;0.00715000000000000;0.00709000000000000;0.00703000000000000;0.00701000000000000;0.00697000000000000;0.00694000000000000;0.00691000000000000;0.00686000000000000;0.00678000000000000;0.00658000000000000;0.00635000000000000;0.00617000000000000;0.00594000000000000;0.00588000000000000;0.00598000000000000;0.00611000000000000;0.00622000000000000;0.00633000000000000;0.00646000000000000;0.00656000000000000;0.00681000000000000;0.00696000000000000;0.00709000000000000;0.00722000000000000;0.00739000000000000;0.00758000000000000;0.00778000000000000;0.00797000000000000;0.00813000000000000;0.00834000000000000;0.00857000000000000;0.00884000000000000;0.00914000000000000;0.00948000000000000;0.00989000000000000;0.0103600000000000;0.0108900000000000;0.0114900000000000;0.0122000000000000;0.0128800000000000;0.0134500000000000;0.0140400000000000;0.0146900000000000;0.0152700000000000;0.0158100000000000;0.0163100000000000;0.0168200000000000;0.0174600000000000;0.0179700000000000;0.0184900000000000;0.0191100000000000;0.0198600000000000;0.0206900000000000;0.0212900000000000;0.0219900000000000;0.0228200000000000;0.0238200000000000;0.0250600000000000;0.0258800000000000;0.0268300000000000;0.0279600000000000;0.0293900000000000;0.0308900000000000;0.0320900000000000;0.0335400000000000;0.0352800000000000;0.0373100000000000;0.0389900000000000;0.0409600000000000;0.0433000000000000;0.0458900000000000;0.0482700000000000;0.0509900000000000;0.0540200000000000;0.0575900000000000;0.0610100000000000;0.0643500000000000;0.0679300000000000;0.0717500000000000;0.0758300000000000;0.0802400000000000;0.0850700000000000;0.0904000000000000];
x_naca4412_cl=[-0.8374;-0.912700000000000;-1.09650000000000;-1.11610000000000;-1.12100000000000;-1.12150000000000;-1.11810000000000;-1.09900000000000;-1.07110000000000;-1.04620000000000;-1.01630000000000;-0.984700000000000;-0.954900000000000;-0.926000000000000;-0.895400000000000;-0.868200000000000;-0.836500000000000;-0.803800000000000;-0.770700000000000;-0.736900000000000;-0.707000000000000;-0.680300000000000;-0.649100000000000;-0.617200000000000;-0.585000000000000;-0.554700000000000;-0.528700000000000;-0.502300000000000;-0.476900000000000;-0.451300000000000;-0.424300000000000;-0.397900000000000;-0.371500000000000;-0.344200000000000;-0.318300000000000;-0.292100000000000;-0.264900000000000;-0.237700000000000;-0.182500000000000;-0.154900000000000;-0.127500000000000;-0.0718000000000000;-0.0441000000000000;-0.0162000000000000;0.0117000000000000;0.0394000000000000;0.0674000000000000;0.0954000000000000;0.123200000000000;0.151200000000000;0.179100000000000;0.206900000000000;0.234600000000000;0.262500000000000;0.290300000000000;0.318000000000000;0.345600000000000;0.373400000000000;0.401200000000000;0.428800000000000;0.456200000000000;0.483300000000000;0.510200000000000;0.536600000000000;0.562200000000000;0.584200000000000;0.616300000000000;0.652500000000000;0.678800000000000;0.705500000000000;0.732500000000000;0.759200000000000;0.786500000000000;0.840500000000000;0.867200000000000;0.894100000000000;0.921000000000000;0.947300000000000;0.973400000000000;0.999300000000000;1.02540000000000;1.05180000000000;1.07770000000000;1.10310000000000;1.12800000000000;1.15230000000000;1.17610000000000;1.19880000000000;1.22080000000000;1.24170000000000;1.26140000000000;1.27930000000000;1.29730000000000;1.31640000000000;1.33460000000000;1.35140000000000;1.36760000000000;1.38350000000000;1.40040000000000;1.41710000000000;1.43170000000000;1.44840000000000;1.46530000000000;1.48050000000000;1.49380000000000;1.50610000000000;1.52210000000000;1.53690000000000;1.55000000000000;1.56080000000000;1.56880000000000;1.58310000000000;1.59590000000000;1.60660000000000;1.61410000000000;1.62130000000000;1.63250000000000;1.64140000000000;1.64740000000000;1.65080000000000;1.65850000000000;1.66380000000000;1.66610000000000;1.66660000000000;1.66980000000000;1.67060000000000;1.66920000000000;1.66380000000000;1.66050000000000;1.65840000000000;1.65480000000000;1.64970000000000;1.64300000000000;1.63460000000000;1.62370000000000;1.60970000000000];

figure(1)
plot(alpha1,clswp1,'-*');
hold on 
plot(naca0012_alpha,naca0012_cl);
hold off
xlabel('\alpha','Fontsize',14);
ylabel('c_l','Fontsize',14);
legend({'Numerical solution','Abbott, I. H. and von Doenhoff'},'Fontsize',10,'Location','best');

%xfoil
figure(2)
plot(alpha1,clswp1,'-*');
hold on 
plot(x_naca0012_alpha,x_naca0012_cl);
hold off
xlabel('\alpha','Fontsize',14);
ylabel('c_l','Fontsize',14);
legend({'Numerical solution','Xfoil'},'Fontsize',10,'Location','best');

figure(3)
plot(alpha2,clswp2,'-*');
hold on 
plot(naca4412_alpha,naca4412_cl);
hold off
xlabel('\alpha','Fontsize',14);
ylabel('c_l','Fontsize',14);
legend({'Numerical solution','Abbott, I. H. and von Doenhoff'},'Fontsize',10,'Location','best');

%xfoil
figure(4)
plot(alpha2,clswp2,'-*');
hold on 
plot(x_naca4412_alpha,x_naca4412_cl);
hold off
xlabel('\alpha','Fontsize',14);
ylabel('c_l','Fontsize',14);
legend({'Numerical solution','Xfoil'},'Fontsize',10,'Location','best');
%xfoil
figure(4)
plot(alpha1,cdswp1,'-*');
hold on 
plot(x_naca0012_alpha,x_naca0012_cd);
hold off
xlabel('\alpha','Fontsize',14);
ylabel('c_d','Fontsize',14);
legend({'Numerical solution','Xfoil'},'Fontsize',10,'Location','best');

figure(5)
plot(alpha1,cdswp1,'-*');
xlabel('\alpha','Fontsize',14);
ylabel('c_d','Fontsize',14);
